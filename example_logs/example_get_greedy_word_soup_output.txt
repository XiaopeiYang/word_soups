python preprocess/get_greedy_word_soup.py --dataset ImageNet --seed 1 --n_descriptors 8
Namespace(dataset='ImageNet', bs=4, seed=1, accum_iter=1, lr=2e-05, wd=1e-05, shots=4, d=512, modelname='ViT-B-16', pretrained='openai', cache_dir='/home/y/yangxi/proj/visualrep/code/word_soups_bio/cache', data_dir='/home/y/yangxi/proj/visualrep/code/word_soups/data', use_patches=False, n_epochs=1, iters_per_epoch=750, lr_decay=0.0, temp=60.0, optimizer='sgd', loss='ce', label_smoothing=0.0, samples_per_class=1, margin=0.0, adaptive_margin=0.0, ema=0.995, visual_prompt_depth=0, visual_prompt_length=3, text_prompt_length=3, text_prompt_depth=1, train_text_encoder=1, train_visual_encoder=1, layer_start_v=9, layer_start_t=9, maple=0, lora=0, bitfit=0, adapter=0, ssf=0, resblock_adapter=0, rank=4, shallow_prompt_init='a photo of', prompt_lr_multi=10.0, eval_only=0, save_model=0, n_descriptors=8, checkpoint='', prompt_rand_init=0, suffix_string='', train_with_descriptors=0, teacher_temp=100.0, init_lam=0.0, skip_ema_iters=0, subsample_classes='all', k0=250, always_select_best=0, k1=1000, patience=250, max_word_length=10)
Loading preprocessed few-shot data from /home/y/yangxi/proj/visualrep/code/word_soups_bio/datasets/splits/imagenet/shot_16-seed_1.pkl
len(dset_base_train):  16000
number of base classes:  1000
prompt tuning with prompt length M=3
shape of text prompt token vectors: torch.Size([3, 512])
shape of prefix token vectors: torch.Size([1, 512])
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4000/4000 [00:50<00:00, 79.49it/s]
loading features from cache/word_features__ViT-B-16_openai.tensor.
word_features.shape:  torch.Size([9894, 1000, 512])
calculating individual accuracies of words
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9894/9894 [00:29<00:00, 335.63it/s]
max individual word acc:  69.90625262260437
best word: 
characteristic
first_word:  misc
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.06875371932983, example: a photo of a tench, misc
  0%|▌                                                                                                                                | 1/251 [00:00<03:48,  1.10it/s]acc now 69.16250586509705, example: a photo of a tench, misc beta
  8%|█████████▋                                                                                                                      | 19/251 [00:10<02:05,  1.85it/s]acc now 69.21875476837158, example: a photo of a tench, misc beta sequence
 12%|███████████████▊                                                                                                                | 31/251 [00:17<01:59,  1.84it/s]acc now 69.31250095367432, example: a photo of a tench, misc beta sequence particularly
 13%|████████████████▊                                                                                                               | 33/251 [00:18<01:58,  1.83it/s]acc now 69.36875581741333, example: a photo of a tench, misc beta sequence particularly pose
 14%|█████████████████▎                                                                                                              | 34/251 [00:18<01:58,  1.83it/s]acc now 69.468754529953, example: a photo of a tench, misc beta sequence particularly pose began
 18%|██████████████████████▍                                                                                                         | 44/251 [00:24<01:54,  1.80it/s]acc now 69.50000524520874, example: a photo of a tench, misc beta sequence particularly pose began mart
 23%|█████████████████████████████                                                                                                   | 57/251 [00:31<01:48,  1.79it/s]acc now 69.63125467300415, example: a photo of a tench, misc beta sequence particularly pose began mart pace
 74%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 185/251 [01:43<00:37,  1.78it/s]acc now 69.7937548160553, example: a photo of a tench, misc beta sequence particularly pose began mart pace weblog
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 243/251 [02:16<00:04,  1.77it/s]acc now 69.85625624656677, example: a photo of a tench, misc beta sequence particularly pose began mart pace weblog wp
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 243/251 [02:16<00:04,  1.78it/s]
Final word chain acc: 69.85625624656677
first_word:  appearance
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.16250586509705, example: a photo of a tench, appearance
  1%|█▌                                                                                                                               | 3/251 [00:01<02:13,  1.85it/s]acc now 69.25625205039978, example: a photo of a tench, appearance blogs
  4%|█████▌                                                                                                                          | 11/251 [00:05<02:10,  1.84it/s]acc now 69.43125128746033, example: a photo of a tench, appearance blogs by
 29%|█████████████████████████████████████▋                                                                                          | 74/251 [00:40<01:37,  1.82it/s]acc now 69.4562554359436, example: a photo of a tench, appearance blogs by wiki
 30%|██████████████████████████████████████▏                                                                                         | 75/251 [00:41<01:36,  1.82it/s]acc now 69.52500343322754, example: a photo of a tench, appearance blogs by wiki specialties
 33%|██████████████████████████████████████████▎                                                                                     | 83/251 [00:45<01:33,  1.80it/s]acc now 69.66875195503235, example: a photo of a tench, appearance blogs by wiki specialties suggestion
 33%|██████████████████████████████████████████▊                                                                                     | 84/251 [00:46<01:32,  1.80it/s]acc now 69.67500448226929, example: a photo of a tench, appearance blogs by wiki specialties suggestion lucia
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 193/251 [01:47<00:32,  1.78it/s]acc now 69.73125338554382, example: a photo of a tench, appearance blogs by wiki specialties suggestion lucia wikipedia
 82%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                       | 205/251 [01:53<00:25,  1.77it/s]acc now 69.76875066757202, example: a photo of a tench, appearance blogs by wiki specialties suggestion lucia wikipedia usually
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 207/251 [01:55<00:24,  1.77it/s]acc now 69.8062539100647, example: a photo of a tench, appearance blogs by wiki specialties suggestion lucia wikipedia usually begun
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 207/251 [01:55<00:24,  1.79it/s]
Final word chain acc: 69.8062539100647
first_word:  prev
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.11250352859497, example: a photo of a tench, prev
  2%|███                                                                                                                              | 6/251 [00:03<02:12,  1.85it/s]acc now 69.20000314712524, example: a photo of a tench, prev till
  3%|████                                                                                                                             | 8/251 [00:04<02:11,  1.85it/s]acc now 69.63125467300415, example: a photo of a tench, prev till weblog
  4%|████▋                                                                                                                            | 9/251 [00:04<02:11,  1.84it/s]acc now 69.68125104904175, example: a photo of a tench, prev till weblog com
  4%|█████                                                                                                                           | 10/251 [00:05<02:11,  1.84it/s]acc now 69.70000267028809, example: a photo of a tench, prev till weblog com liable
  8%|██████████▏                                                                                                                     | 20/251 [00:10<02:07,  1.81it/s]acc now 69.73750591278076, example: a photo of a tench, prev till weblog com liable that
 10%|████████████▏                                                                                                                   | 24/251 [00:13<02:06,  1.80it/s]acc now 69.80000138282776, example: a photo of a tench, prev till weblog com liable that elsewhere
 11%|██████████████▎                                                                                                                 | 28/251 [00:15<02:04,  1.79it/s]acc now 69.96875405311584, example: a photo of a tench, prev till weblog com liable that elsewhere zum
 12%|███████████████▎                                                                                                                | 30/251 [00:16<02:03,  1.78it/s]acc now 69.9750006198883, example: a photo of a tench, prev till weblog com liable that elsewhere zum fotos
 14%|█████████████████▎                                                                                                              | 34/251 [00:18<02:02,  1.77it/s]acc now 70.06875276565552, example: a photo of a tench, prev till weblog com liable that elsewhere zum fotos mention
 14%|█████████████████▎                                                                                                              | 34/251 [00:19<02:03,  1.76it/s]
Final word chain acc: 70.06875276565552
first_word:  whether
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.20625567436218, example: a photo of a tench, whether
  0%|▌                                                                                                                                | 1/251 [00:00<02:14,  1.86it/s]acc now 69.41875219345093, example: a photo of a tench, whether variation
  3%|███▌                                                                                                                             | 7/251 [00:03<02:13,  1.83it/s]acc now 69.4562554359436, example: a photo of a tench, whether variation mambo
  4%|█████                                                                                                                           | 10/251 [00:05<02:11,  1.83it/s]acc now 69.47500109672546, example: a photo of a tench, whether variation mambo too
  6%|████████▏                                                                                                                       | 16/251 [00:08<02:09,  1.81it/s]acc now 69.4937527179718, example: a photo of a tench, whether variation mambo too claimed
 15%|███████████████████▍                                                                                                            | 38/251 [00:20<01:58,  1.80it/s]acc now 69.5062518119812, example: a photo of a tench, whether variation mambo too claimed das
 16%|████████████████████▍                                                                                                           | 40/251 [00:22<01:57,  1.80it/s]acc now 69.68750357627869, example: a photo of a tench, whether variation mambo too claimed das previous
 17%|█████████████████████▉                                                                                                          | 43/251 [00:23<01:56,  1.79it/s]acc now 69.9500024318695, example: a photo of a tench, whether variation mambo too claimed das previous referring
 29%|█████████████████████████████████████▋                                                                                          | 74/251 [00:41<01:39,  1.78it/s]acc now 70.02500295639038, example: a photo of a tench, whether variation mambo too claimed das previous referring vary
 61%|████████████████████████████████████████████████████████████████████████████▉                                                  | 152/251 [01:25<00:56,  1.76it/s]acc now 70.07500529289246, example: a photo of a tench, whether variation mambo too claimed das previous referring vary silly
 61%|████████████████████████████████████████████████████████████████████████████▉                                                  | 152/251 [01:26<00:56,  1.77it/s]
Final word chain acc: 70.07500529289246
first_word:  entry
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 68.88750195503235, example: a photo of a tench, entry
  1%|█▌                                                                                                                               | 3/251 [00:01<02:14,  1.85it/s]acc now 69.43750381469727, example: a photo of a tench, entry wiki
  4%|█████▌                                                                                                                          | 11/251 [00:05<02:10,  1.84it/s]acc now 69.44375038146973, example: a photo of a tench, entry wiki entire
  5%|██████                                                                                                                          | 12/251 [00:06<02:09,  1.84it/s]acc now 69.51250433921814, example: a photo of a tench, entry wiki entire additionally
  7%|████████▋                                                                                                                       | 17/251 [00:09<02:08,  1.82it/s]acc now 69.62500214576721, example: a photo of a tench, entry wiki entire additionally emphasis
  8%|█████████▋                                                                                                                      | 19/251 [00:10<02:07,  1.81it/s]acc now 69.76250410079956, example: a photo of a tench, entry wiki entire additionally emphasis er
  8%|██████████▏                                                                                                                     | 20/251 [00:10<02:07,  1.81it/s]acc now 69.86875534057617, example: a photo of a tench, entry wiki entire additionally emphasis er however
 10%|████████████▏                                                                                                                   | 24/251 [00:13<02:06,  1.79it/s]acc now 70.01250386238098, example: a photo of a tench, entry wiki entire additionally emphasis er however weblog
 10%|████████████▋                                                                                                                   | 25/251 [00:13<02:06,  1.79it/s]acc now 70.20000219345093, example: a photo of a tench, entry wiki entire additionally emphasis er however weblog similarly
 41%|████████████████████████████████████████████████████                                                                           | 103/251 [00:58<01:24,  1.75it/s]acc now 70.21250128746033, example: a photo of a tench, entry wiki entire additionally emphasis er however weblog similarly yes
 41%|████████████████████████████████████████████████████                                                                           | 103/251 [00:58<01:24,  1.75it/s]
Final word chain acc: 70.21250128746033
first_word:  funny
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.06875371932983, example: a photo of a tench, funny
  0%|▌                                                                                                                                | 1/251 [00:00<02:14,  1.86it/s]acc now 69.14375424385071, example: a photo of a tench, funny emphasis
  1%|█                                                                                                                                | 2/251 [00:01<02:14,  1.85it/s]acc now 69.20000314712524, example: a photo of a tench, funny emphasis prerequisite
  1%|█▌                                                                                                                               | 3/251 [00:01<02:14,  1.84it/s]acc now 69.38125491142273, example: a photo of a tench, funny emphasis prerequisite particular
  4%|████▋                                                                                                                            | 9/251 [00:04<02:13,  1.81it/s]acc now 69.53750252723694, example: a photo of a tench, funny emphasis prerequisite particular courtesy
  9%|███████████▋                                                                                                                    | 23/251 [00:12<02:07,  1.79it/s]acc now 69.55000162124634, example: a photo of a tench, funny emphasis prerequisite particular courtesy rules
 11%|██████████████▎                                                                                                                 | 28/251 [00:15<02:04,  1.79it/s]acc now 69.57500576972961, example: a photo of a tench, funny emphasis prerequisite particular courtesy rules open
 15%|██████████████████▊                                                                                                             | 37/251 [00:20<02:00,  1.78it/s]acc now 69.77500319480896, example: a photo of a tench, funny emphasis prerequisite particular courtesy rules open hope
 27%|██████████████████████████████████▏                                                                                             | 67/251 [00:37<01:44,  1.77it/s]acc now 69.7812557220459, example: a photo of a tench, funny emphasis prerequisite particular courtesy rules open hope point
 43%|███████████████████████████████████████████████████████▏                                                                       | 109/251 [01:01<01:21,  1.75it/s]acc now 69.8312520980835, example: a photo of a tench, funny emphasis prerequisite particular courtesy rules open hope point stupid
 43%|███████████████████████████████████████████████████████▏                                                                       | 109/251 [01:02<01:20,  1.76it/s]
Final word chain acc: 69.8312520980835
first_word:  showed
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.20000314712524, example: a photo of a tench, showed
  1%|█                                                                                                                                | 2/251 [00:01<02:15,  1.84it/s]acc now 69.42500472068787, example: a photo of a tench, showed prefix
 21%|██████████████████████████▌                                                                                                     | 52/251 [00:28<01:48,  1.83it/s]acc now 69.4812536239624, example: a photo of a tench, showed prefix pose
 53%|██████████████████████████████████████████████████████████████████▊                                                            | 132/251 [01:12<01:05,  1.82it/s]acc now 69.4937527179718, example: a photo of a tench, showed prefix pose involved
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 133/251 [01:12<01:04,  1.82it/s]acc now 69.51250433921814, example: a photo of a tench, showed prefix pose involved latino
 55%|█████████████████████████████████████████████████████████████████████▎                                                         | 137/251 [01:15<01:03,  1.81it/s]acc now 69.54375505447388, example: a photo of a tench, showed prefix pose involved latino along
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 239/251 [02:12<00:06,  1.79it/s]acc now 69.63125467300415, example: a photo of a tench, showed prefix pose involved latino along typically
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 249/251 [02:18<00:01,  1.78it/s]acc now 69.77500319480896, example: a photo of a tench, showed prefix pose involved latino along typically proprietary
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 251/251 [02:19<00:00,  1.80it/s]
Final word chain acc: 69.77500319480896
first_word:  ww
  0%|                                                                                                                                         | 0/251 [00:00<?, ?it/s]acc now 69.10625100135803, example: a photo of a tench, ww
  2%|██                                                                                                                               | 4/251 [00:02<02:13,  1.85it/s]acc now 69.36875581741333, example: a photo of a tench, ww namely
 11%|█████████████▊                                                                                                                  | 27/251 [00:14<02:02,  1.83it/s]acc now 69.51250433921814, example: a photo of a tench, ww namely thereof
 13%|████████████████▊                                                                                                               | 33/251 [00:17<01:59,  1.82it/s]acc now 69.55625414848328, example: a photo of a tench, ww namely thereof seriously
 14%|█████████████████▊                                                                                                              | 35/251 [00:19<01:58,  1.82it/s]acc now 69.58125233650208, example: a photo of a tench, ww namely thereof seriously q
 16%|███████████████████▉                                                                                                            | 39/251 [00:21<01:57,  1.81it/s]acc now 69.7812557220459, example: a photo of a tench, ww namely thereof seriously q varies
 17%|█████████████████████▉                                                                                                          | 43/251 [00:23<01:55,  1.80it/s]acc now 69.80000138282776, example: a photo of a tench, ww namely thereof seriously q varies ons
 24%|██████████████████████████████                                                                                                  | 59/251 [00:32<01:47,  1.78it/s]acc now 69.93750333786011, example: a photo of a tench, ww namely thereof seriously q varies ons they
 37%|███████████████████████████████████████████████▍                                                                                | 93/251 [00:52<01:28,  1.78it/s]acc now 70.06875276565552, example: a photo of a tench, ww namely thereof seriously q varies ons they actually
 71%|██████████████████████████████████████████████████████████████████████████████████████████                                     | 178/251 [01:40<00:41,  1.77it/s]acc now 70.20625472068787, example: a photo of a tench, ww namely thereof seriously q varies ons they actually herein
 71%|██████████████████████████████████████████████████████████████████████████████████████████                                     | 178/251 [01:40<00:41,  1.77it/s]
Final word chain acc: 70.20625472068787